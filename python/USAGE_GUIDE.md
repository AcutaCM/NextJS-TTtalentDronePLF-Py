# Telloæ— äººæœºå¤šæ¨¡å‹æ£€æµ‹ç³»ç»Ÿä½¿ç”¨æŒ‡å—

## ğŸ¯ ç³»ç»Ÿæ¦‚è¿°

è¿™æ˜¯ä¸€ä¸ªé‡å†™çš„Telloæ— äººæœºæ£€æµ‹å™¨ï¼ŒåŸºäºYOLOv11ç®—æ³•ï¼Œæ”¯æŒå¤šæ¨¡å‹éƒ¨ç½²ï¼š
- **æˆç†Ÿåº¦æ£€æµ‹æ¨¡å‹** (best.pt): è¯†åˆ«ä½œç‰©æˆç†Ÿç¨‹åº¦
- **ç—…å®³æ£€æµ‹æ¨¡å‹** (disease.pt): è¯†åˆ«æ¤ç‰©ç—…å®³

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•1: ä½¿ç”¨å¯åŠ¨è„šæœ¬ï¼ˆæ¨èï¼‰
```bash
# Windows
åŒå‡» start_multi_detector.bat

# Linux/Mac
./start_multi_detector.sh
```

### æ–¹æ³•2: æ‰‹åŠ¨å¯åŠ¨
```bash
cd drone-analyzer-nextjs/python
python tello_multi_detector_backend.py --ws-port 3003
```

## ğŸ“± è¿æ¥å’Œæ§åˆ¶

### 1. è¿æ¥Telloæ— äººæœº
1. å¼€å¯Telloæ— äººæœº
2. è¿æ¥åˆ°Telloçš„WiFiç½‘ç»œ
3. åœ¨å‰ç«¯ç•Œé¢ç‚¹å‡»"è¿æ¥æ— äººæœº"

### 2. å¯ç”¨æ£€æµ‹åŠŸèƒ½
- **æˆç†Ÿåº¦æ£€æµ‹**: è¯†åˆ«ripe(æˆç†Ÿ)ã€semi_ripe(åŠæˆç†Ÿ)ã€unripe(æœªæˆç†Ÿ)
- **ç—…å®³æ£€æµ‹**: è¯†åˆ«healthy(å¥åº·)ã€leaf_spot(å¶æ–‘ç—…)ã€powdery_mildew(ç™½ç²‰ç—…)ç­‰

### 3. é£è¡Œæ§åˆ¶
- èµ·é£/é™è½
- æ‰‹åŠ¨æ§åˆ¶ï¼ˆå‰åå·¦å³ã€ä¸Šä¸‹ã€æ—‹è½¬ï¼‰
- ç´§æ€¥åœæ­¢

## ğŸ›ï¸ WebSocket API

### è¿æ¥åœ°å€
```
ws://localhost:3003
```

### ä¸»è¦æ¶ˆæ¯ç±»å‹

#### æ— äººæœºæ§åˆ¶
```json
// è¿æ¥æ— äººæœº
{"type": "drone_connect", "data": {}}

// èµ·é£
{"type": "drone_takeoff", "data": {}}

// é™è½
{"type": "drone_land", "data": {}}
```

#### æ£€æµ‹æ§åˆ¶
```json
// å¯ç”¨æˆç†Ÿåº¦æ£€æµ‹
{"type": "enable_maturity_detection", "data": {}}

// å¯ç”¨ç—…å®³æ£€æµ‹
{"type": "enable_disease_detection", "data": {}}
```

#### æ£€æµ‹ç»“æœ
```json
{
  "type": "multi_model_detection",
  "data": {
    "detections": [
      {
        "bbox": [x1, y1, x2, y2],
        "confidence": 0.85,
        "class_name": "ripe",
        "model_type": "maturity",
        "track_id": "maturity_1"
      }
    ],
    "summary": {
      "total_count": 5,
      "maturity_analysis": {"ripe": 2, "semi_ripe": 1},
      "disease_analysis": {"healthy": 1, "diseased": 1}
    }
  }
}
```

## âš™ï¸ æ€§èƒ½ä¼˜åŒ–

### æ£€æµ‹å‚æ•°è°ƒæ•´
åœ¨ `config_multi_model.json` ä¸­è°ƒæ•´ï¼š
```json
{
  "detection_settings": {
    "maturity_confidence_threshold": 0.2,
    "disease_confidence_threshold": 0.25,
    "detection_interval": 0.1,
    "track_timeout": 2.0
  }
}
```

### ç¡¬ä»¶ä¼˜åŒ–
- **GPUåŠ é€Ÿ**: å®‰è£…CUDAç‰ˆæœ¬çš„PyTorch
- **å†…å­˜ä¼˜åŒ–**: è°ƒæ•´batch_sizeå’Œmemory_limit_mb
- **CPUä¼˜åŒ–**: è°ƒæ•´num_threadså‚æ•°

## ğŸ”§ æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ— äººæœºè¿æ¥å¤±è´¥**
   - æ£€æŸ¥WiFiè¿æ¥åˆ°Telloç½‘ç»œ
   - ç¡®è®¤æ— äººæœºå·²å¼€æœºä¸”ç”µé‡å……è¶³
   - é‡å¯æ— äººæœºå’Œç¨‹åº

2. **æ¨¡å‹åŠ è½½å¤±è´¥**
   - ç¡®è®¤modelsç›®å½•ä¸‹æœ‰best.ptå’Œdisease.ptæ–‡ä»¶
   - æ£€æŸ¥æ–‡ä»¶æƒé™å’Œè·¯å¾„
   - é‡æ–°ä¸‹è½½æ¨¡å‹æ–‡ä»¶

3. **æ£€æµ‹æ•ˆæœå·®**
   - è°ƒæ•´ç½®ä¿¡åº¦é˜ˆå€¼ï¼ˆé™ä½é˜ˆå€¼æé«˜å¬å›ç‡ï¼‰
   - æ”¹å–„å…‰ç…§æ¡ä»¶
   - è°ƒæ•´æ— äººæœºé£è¡Œé«˜åº¦å’Œè§’åº¦

4. **æ€§èƒ½é—®é¢˜**
   - å¢åŠ detection_intervalå‡å°‘æ£€æµ‹é¢‘ç‡
   - é™ä½è§†é¢‘è´¨é‡è®¾ç½®
   - å…³é—­ä¸éœ€è¦çš„æ£€æµ‹æ¨¡å‹

### æ—¥å¿—æŸ¥çœ‹
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f multi_detector.log

# æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
grep "ERROR" multi_detector.log
```

## ğŸ“Š æ£€æµ‹ç»“æœè¯´æ˜

### æˆç†Ÿåº¦æ£€æµ‹
- **ripe**: æˆç†Ÿï¼Œå¯ä»¥é‡‡æ‘˜
- **semi_ripe**: åŠæˆç†Ÿï¼Œéœ€è¦ç»§ç»­è§‚å¯Ÿ
- **unripe**: æœªæˆç†Ÿï¼Œä¸å»ºè®®é‡‡æ‘˜

### ç—…å®³æ£€æµ‹
- **healthy**: å¥åº·æ¤ç‰©
- **leaf_spot**: å¶æ–‘ç—…ï¼Œéœ€è¦æ²»ç–—
- **powdery_mildew**: ç™½ç²‰ç—…ï¼Œéœ€è¦æ€èŒå‰‚
- **rust**: é”ˆç—…ï¼Œéœ€è¦é“œåŸºæ€èŒå‰‚
- **blight**: æ¯èç—…ï¼Œéœ€è¦ç³»ç»Ÿæ€§æ²»ç–—
- **mosaic_virus**: èŠ±å¶ç—…æ¯’ï¼Œéœ€è¦éš”ç¦»å¤„ç†

## ğŸ”„ ç³»ç»Ÿç»´æŠ¤

### å®šæœŸç»´æŠ¤
1. æ¸…ç†æ£€æµ‹å†å²ï¼šå‘é€`clear_detection_history`æ¶ˆæ¯
2. é‡å¯æœåŠ¡ï¼šåœæ­¢ç¨‹åºåé‡æ–°å¯åŠ¨
3. æ›´æ–°æ¨¡å‹ï¼šæ›¿æ¢modelsç›®å½•ä¸‹çš„.ptæ–‡ä»¶

### å¤‡ä»½é…ç½®
```bash
# å¤‡ä»½é…ç½®æ–‡ä»¶
cp config_multi_model.json config_backup.json

# å¤‡ä»½æ—¥å¿—æ–‡ä»¶
cp multi_detector.log logs/backup_$(date +%Y%m%d).log
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š
1. é”™è¯¯æ—¥å¿—å†…å®¹
2. ç³»ç»Ÿç¯å¢ƒä¿¡æ¯
3. æ— äººæœºå‹å·å’Œå›ºä»¶ç‰ˆæœ¬
4. å…·ä½“æ“ä½œæ­¥éª¤

---

**æ³¨æ„**: ä½¿ç”¨æ— äººæœºæ—¶è¯·éµå®ˆå½“åœ°æ³•å¾‹æ³•è§„ï¼Œç¡®ä¿é£è¡Œå®‰å…¨ã€‚